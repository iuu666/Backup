/*
酷狗概念版每日自动领取VIP-Eric
*/
var iｉl='jsjiami.cn.v7';function iI1Ii11I(_0x429dac,_0x317d8f){const _0x5a6659=ll11iI11();return iI1Ii11I=function(_0x27e591,_0x25b296){_0x27e591=_0x27e591-0x69;let _0x516e8a=_0x5a6659[_0x27e591];if(iI1Ii11I['bnNNEh']===undefined){var _0xf75477=function(_0x21e751){const _0x6644ff='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x224fb5='',_0x110962='',_0x5b236f=_0x224fb5+_0xf75477;for(let _0x246261=0x0,_0x3ebade,_0x1306c2,_0x24d488=0x0;_0x1306c2=_0x21e751['charAt'](_0x24d488++);~_0x1306c2&&(_0x3ebade=_0x246261%0x4?_0x3ebade*0x40+_0x1306c2:_0x1306c2,_0x246261++%0x4)?_0x224fb5+=_0x5b236f['charCodeAt'](_0x24d488+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x3ebade>>(-0x2*_0x246261&0x6)):_0x246261:0x0){_0x1306c2=_0x6644ff['indexOf'](_0x1306c2);}for(let _0xb130b=0x0,_0x1584e3=_0x224fb5['length'];_0xb130b<_0x1584e3;_0xb130b++){_0x110962+='%'+('00'+_0x224fb5['charCodeAt'](_0xb130b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x110962);};const _0x1c7c5b=function(_0xfe3d14,_0x302514){let _0x209023=[],_0x338536=0x0,_0x422c99,_0x5af8ee='';_0xfe3d14=_0xf75477(_0xfe3d14);let _0x117c2d;for(_0x117c2d=0x0;_0x117c2d<0x100;_0x117c2d++){_0x209023[_0x117c2d]=_0x117c2d;}for(_0x117c2d=0x0;_0x117c2d<0x100;_0x117c2d++){_0x338536=(_0x338536+_0x209023[_0x117c2d]+_0x302514['charCodeAt'](_0x117c2d%_0x302514['length']))%0x100,_0x422c99=_0x209023[_0x117c2d],_0x209023[_0x117c2d]=_0x209023[_0x338536],_0x209023[_0x338536]=_0x422c99;}_0x117c2d=0x0,_0x338536=0x0;for(let _0x4b15ed=0x0;_0x4b15ed<_0xfe3d14['length'];_0x4b15ed++){_0x117c2d=(_0x117c2d+0x1)%0x100,_0x338536=(_0x338536+_0x209023[_0x117c2d])%0x100,_0x422c99=_0x209023[_0x117c2d],_0x209023[_0x117c2d]=_0x209023[_0x338536],_0x209023[_0x338536]=_0x422c99,_0x5af8ee+=String['fromCharCode'](_0xfe3d14['charCodeAt'](_0x4b15ed)^_0x209023[(_0x209023[_0x117c2d]+_0x209023[_0x338536])%0x100]);}return _0x5af8ee;};iI1Ii11I['xiOJxF']=_0x1c7c5b,_0x429dac=arguments,iI1Ii11I['bnNNEh']=!![];}const _0x85907e=_0x5a6659[0x0],_0x5583b2=_0x27e591+_0x85907e,_0x559619=_0x429dac[_0x5583b2];if(!_0x559619){if(iI1Ii11I['Dmwufr']===undefined){const _0x2714c7=function(_0x4ae258){this['gZDFGN']=_0x4ae258,this['ZkXUUB']=[0x1,0x0,0x0],this['VuGSLn']=function(){return'newState';},this['UUBZfE']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bPCjwR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2714c7['prototype']['JCwlqR']=function(){const _0x582e84=new RegExp(this['UUBZfE']+this['bPCjwR']),_0x24db7b=_0x582e84['test'](this['VuGSLn']['toString']())?--this['ZkXUUB'][0x1]:--this['ZkXUUB'][0x0];return this['nklItV'](_0x24db7b);},_0x2714c7['prototype']['nklItV']=function(_0x1d4592){if(!Boolean(~_0x1d4592))return _0x1d4592;return this['LgFLND'](this['gZDFGN']);},_0x2714c7['prototype']['LgFLND']=function(_0x1b4e64){for(let _0x4c0c1f=0x0,_0x2e42cb=this['ZkXUUB']['length'];_0x4c0c1f<_0x2e42cb;_0x4c0c1f++){this['ZkXUUB']['push'](Math['round'](Math['random']())),_0x2e42cb=this['ZkXUUB']['length'];}return _0x1b4e64(this['ZkXUUB'][0x0]);},new _0x2714c7(iI1Ii11I)['JCwlqR'](),iI1Ii11I['Dmwufr']=!![];}_0x516e8a=iI1Ii11I['xiOJxF'](_0x516e8a,_0x25b296),_0x429dac[_0x5583b2]=_0x516e8a;}else _0x516e8a=_0x559619;return _0x516e8a;},iI1Ii11I(_0x429dac,_0x317d8f);}const lII11I=iI1Ii11I;(function(iIiIll1I,illllIl,IlIiI1Ii,ilIlII1l,i1lIlIl,lIi1iIII,IiiIIiI1){return iIiIll1I=iIiIll1I>>0x3,lIi1iIII='hs',IiiIIiI1='hs',function(ilIlll,ili1iII1,lIIiIi1l,IIIill1,lliIlIil){const lIIIlIli=iI1Ii11I;IIIill1='tfi',lIi1iIII=IIIill1+lIi1iIII,lliIlIil='up',IiiIIiI1+=lliIlIil,lIi1iIII=lIIiIi1l(lIi1iIII),IiiIIiI1=lIIiIi1l(IiiIIiI1),lIIiIi1l=0x0;const IiIIl11i=ilIlll();while(!![]&&--ilIlII1l+ili1iII1){try{IIIill1=-parseInt(lIIIlIli(0xb2,'0d[&'))/0x1*(-parseInt(lIIIlIli(0x9c,'CP1n'))/0x2)+parseInt(lIIIlIli(0xcc,'H8$Q'))/0x3*(-parseInt(lIIIlIli(0x9f,'DtfC'))/0x4)+parseInt(lIIIlIli(0xe9,'nL5P'))/0x5*(-parseInt(lIIIlIli(0x84,'k(V8'))/0x6)+parseInt(lIIIlIli(0xd2,'@Wt0'))/0x7*(parseInt(lIIIlIli(0xd5,'C@rU'))/0x8)+parseInt(lIIIlIli(0xc4,'6nXW'))/0x9+parseInt(lIIIlIli(0x80,'H8$Q'))/0xa*(-parseInt(lIIIlIli(0x7a,'6nXW'))/0xb)+parseInt(lIIIlIli(0xb9,'*EZM'))/0xc;}catch(i1I1i11){IIIill1=lIIiIi1l;}finally{lliIlIil=IiIIl11i[lIi1iIII]();if(iIiIll1I<=ilIlII1l)lIIiIi1l?i1lIlIl?IIIill1=lliIlIil:i1lIlIl=lliIlIil:lIIiIi1l=lliIlIil;else{if(lIIiIi1l==i1lIlIl['replace'](/[qkOxETwGhbtLWJVNKe=]/g,'')){if(IIIill1===ili1iII1){IiIIl11i['un'+lIi1iIII](lliIlIil);break;}IiIIl11i[IiiIIiI1](lliIlIil);}}}}}(IlIiI1Ii,illllIl,function(liilI11,Ili11l1I,l1l1IIll,i1l1iII1,lIIIl1I1,iIi11I1l,iIII1II){return Ili11l1I='\x73\x70\x6c\x69\x74',liilI11=arguments[0x0],liilI11=liilI11[Ili11l1I](''),l1l1IIll=`\x72\x65\x76\x65\x72\x73\x65`,liilI11=liilI11[l1l1IIll]('\x76'),i1l1iII1=`\x6a\x6f\x69\x6e`,(0x17f44d,liilI11[i1l1iII1](''));});}(0x618,0xc8f3f,ll11iI11,0xc5),ll11iI11)&&(iｉl=0xc5);const l1IIil=new Env(lII11I(0x6e,'8y9&'));function il11ii1(iIlliii){const IliIIIi=lII11I,IiilI1li={'yKXXS':IliIIIi(0x71,'t5DJ'),'szSYs':function(lil1l1li,li1iiiii){return lil1l1li!==li1iiiii;},'LuUNV':IliIIIi(0x95,'DtfC'),'SVjMs':function(l11IlIiI,iIll1liI,llllIlI1){return l11IlIiI(iIll1liI,llllIlI1);},'YhYZS':function(liIiI1l1){return liIiI1l1();},'vKQQc':IliIIIi(0x83,'1qLd'),'YApns':IliIIIi(0xb4,'@Wt0'),'Iovaq':IliIIIi(0x87,'VJ7U')},iIiII11i=(function(){const ilI11i=IliIIIi;if(IiilI1li[ilI11i(0x94,'oemk')](IiilI1li[ilI11i(0xe7,'JL4G')],IiilI1li[ilI11i(0x99,'WxCw')]))return iilIiili[ilI11i(0xd0,'CFR&')]()[ilI11i(0x96,'EvtB')](ZOwbCx[ilI11i(0xbd,'*vpt')])[ilI11i(0x76,'Rdok')]()[ilI11i(0x97,'H8$Q')](lIil1il1)[ilI11i(0xa2,'JL4G')](ZOwbCx[ilI11i(0xac,'0d[&')]);else{let iIi1liI1=!![];return function(iiiII11i,i1i1l1II){const l11ili=iIi1liI1?function(){const IIlI1Il1=iI1Ii11I;if(i1i1l1II){const liIi1I11=i1i1l1II[IIlI1Il1(0xa1,'nfPW')](iiiII11i,arguments);return i1i1l1II=null,liIi1I11;}}:function(){};return iIi1liI1=![],l11ili;};}}()),l1illl11=IiilI1li[IliIIIi(0xe5,'!Y98')](iIiII11i,this,function(){const IIi1illi=IliIIIi;return l1illl11[IIi1illi(0xd3,'!kYb')]()[IIi1illi(0xc6,'qqN9')](IiilI1li[IIi1illi(0x7f,'vQEW')])[IIi1illi(0xef,'U0Qv')]()[IIi1illi(0xec,'C@rU')](l1illl11)[IIi1illi(0xe6,'CP1n')](IiilI1li[IIi1illi(0x8e,'U0Qv')]);});IiilI1li[IliIIIi(0x6a,'Y&[3')](l1illl11);if(IiilI1li[IliIIIi(0x6f,'qqN9')](typeof $prefs,IiilI1li[IliIIIi(0x74,'*vpt')]))return IiilI1li[IliIIIi(0x9e,'CFR&')](IiilI1li[IliIIIi(0xbf,'!Y98')],IiilI1li[IliIIIi(0x69,'DtfC')])?JSON[IliIIIi(0x9b,'DT7R')]($prefs[IliIIIi(0x6b,'j!TL')](iIlliii))||{}:lli1llIl[IliIIIi(0x6c,'sqxp')](li1111I1[IliIIIi(0xd9,'CFR&')](liiII1I1))||{};else{if(IiilI1li[IliIIIi(0xa0,'a*H8')](typeof $persistentStore,IiilI1li[IliIIIi(0x93,'WxCw')]))return JSON[IliIIIi(0x8d,'KXVO')]($persistentStore[IliIIIi(0xd8,'vQEW')](iIlliii))||{};else{if(IiilI1li[IliIIIi(0x88,'@Wt0')](typeof $persistent,IiilI1li[IliIIIi(0x77,'j!TL')]))return JSON[IliIIIi(0xc5,'nL5P')]($persistent[IliIIIi(0xc8,'WxCw')](iIlliii))||{};}}return{};}let IliIIII=il11ii1(lII11I(0xca,'C@rU')),i1IIllil=il11ii1(lII11I(0xc3,'JL4G')),I1IiIiIl=il11ii1(lII11I(0x73,'oLOy')),iI1111iI=lII11I(0xba,'JL4G')+IliIIII[lII11I(0xc0,'!Y98')]+lII11I(0x78,'##SG')+IliIIII[lII11I(0xb3,'oemk')]+lII11I(0x92,'x4e(')+IliIIII[lII11I(0xdc,'nL5P')]+lII11I(0x6d,'2!aa')+IliIIII[lII11I(0xe4,'##SG')]+lII11I(0xdd,'!Y98')+IliIIII[lII11I(0x79,'*EZM')]+lII11I(0xb8,'##SG')+IliIIII[lII11I(0xea,'8y9&')]+lII11I(0xd7,'@Wt0')+IliIIII[lII11I(0xee,'H8$Q')]+lII11I(0xe2,'1qLd')+IliIIII[lII11I(0x70,'M9N)')]+lII11I(0x86,'sqxp')+IliIIII[lII11I(0xae,'a*H8')]+lII11I(0xc7,'CFR&')+IliIIII[lII11I(0xa6,'0d[&')],IiiliI={':authority':i1IIllil[lII11I(0x72,'nL5P')],'content-type':i1IIllil[lII11I(0xa4,'JSnU')],'kg-rf':i1IIllil[lII11I(0xcb,'cz^l')],'accept':i1IIllil[lII11I(0x75,'*vpt')],'kg-thash':i1IIllil[lII11I(0xe0,'*EZM')],'accept-language':i1IIllil[lII11I(0x81,'DT7R')],'accept-encoding':i1IIllil[lII11I(0xa3,'CP1n')],'kg-rec':i1IIllil[lII11I(0x8b,'JL4G')],'user-agent':i1IIllil[lII11I(0x7e,'WxCw')],'kg-rc':i1IIllil[lII11I(0xda,'DtfC')],'kg-fake':i1IIllil[lII11I(0xb6,'pESu')],'content-length':i1IIllil[lII11I(0xd6,'6nXW')],'uni-useragent':i1IIllil[lII11I(0xeb,'VJ7U')]};const l1I1Il1={'url':iI1111iI,'headers':IiiliI};function ll11iI11(){const i1Ii1li1=(function(){return[...[iｉl,'eKxjKsOKhjbJLiaGWqmttViGq.tOctnwN.TvE7k==','jSk8WROkvq','qCkvhCkBW4OOkmoH','iMbcWQFcUq','WPnudCoBWOa','urC2W5RdICoqr13cTwBdSW','brvtWQDu','lZldGHdcMG','6ysP54Mh5QwZ5B2654QV6iE65yMv6Agm5y6IvSowW4y','x2Pjhgi','WOHPW7JcTtNcVq','W7VdK3NcSSk5w8ool2pcVctdPa','W7pdVmkgW5RdRmkhWPxcV8kiwq','WOVcOmkeESoPn20hWOi2WRi','p3JdLmk7pa','kfddPSkpl8oA','WRxcMgFcUh7cOd/cLG','ut0lW77dJW','WRuItcVcN8k3AbO1ySkk','WQvEWQ3dTa','W4RdJGNdQmkhWQHbmSk5','W4hcLCoWFtefW60oWR0sW6/dTeS','m8oJWPy','WOdcVCkdEa','WQdcMmkkovvzW5jqjwG','WO1Dv8oMua','A8oHW6LCc8k/W7BdT2VcP8kY','cConW5pcTCktq8kru1xcMsz7qSo3tW','WPXWWPtdR1maWP8','W7JcLGDBe8orFfCc','W4RcNSoXDdCcW6SQWQizW4tdR1e','WQn2bmoMWRG','uWDtWRDqWP7cVX7dGHW','WRtdIbfatG','WPakySo5yq','5PEv5RcV6kAT5P2/5P615yUG5zIU6l2s5zMH55MM5PwD5O2R','WQtdUdnOlN8nww0','W4ntW7/dIKei','WOBcM8kMwSor','W4BdJSoBB8kr','tmkXfSk3W6S','WRNcHmki','W5ddGmoCoJldJKNcH1DrWQVcSMa','WPVdSCoEW4hcG8oVnWtcJN4ZWRZcJW','WPXuvtFdSSkfWRuYs1hdVmoF','WQpcOmk+gHS','fmoAWONcHtG','cx9EWRdcJq','WPT6W54ZW7pdHG','mCk8WR8Ct8kgW4/dJuJcR8ky','WO11W67cSW','WPNcNSk6bs4','WO13xCoguG','gmopW4lcO8kg','vgldNshcPCk0WPO','W4BcRmkm','A8kHywSn','wJ0bW7xdVCohWRBcLq0Rj1ddOW','W5NcUCk4WQVdHq','WP5tgSk2fq','W5TrWRpdIKCd','auxdUbpcOSkRW7pcRLJcN8k5WOZcLCkhoa','W5f/pCoVeGesiSkXiSkdFG','W5ldP8oAuCkv','AgRcMmkzWQxcTb1RjG','6k++5RcD5ywr6zwTWP0','WQhcQepdPCkX','5B675As25Bwn6Aoh5y2g5Pwo6z6J5yAg6AkU'],...(function(){return['WRfBWRtdVgS','d1/dV8kfgW','yKJcP8kVWPC','6kAd5P625zgw5BUI5PAI5O6X5ysK6zEsda','W5NcSCkiWPpdHSkMAci','W4GLW694WPm','W4PwsY3dSG','WRJcLMBcTf0','lZFdICogW7pcMt1VlvZdUq','bmomWRpcUsulWPL3W7W','WQuxC8oIxa','e0jSWP7cM8opFvNcKe3dGG','WO3cL8obBghcLXq','6i6S5y+v5OUV5yMO','WRuLrIVcNSoK','W6KyW7xcQcq1W6VcOSkmW4hdTCooWOS','W4baWQBdIfDrW7tdN0JdRsTuW4/cVSoqWRukCYLYDCoXDSkyW5uWkGlcS8oBW7VdJsJdHmkRxcRcTSkbWQDXWPJdPY7cNb1XWQFdJWqDrSkgW77cUCkTWPxdKmoNW5yvfmkyWPtcKSojWQu2u0TiafhdKW','6kwr5P6a5AwI6lA+','WO4dvG','mhJdNCkYda','W7VcPCodWP/cTmoyW5pcK8kZsH9ZgW','W5GlW5LYWQK','W6a6W5L1WR4','W6FcTCkdW4/cKmolWR7dKejboG','6i6+5y6j5AAA6lwr','W4brWRpdNeezWOVcKv3dRtjc','W4JdJG7cUSoCW7SiomkSa8ocWPRdQW','WRNdVmkbW53dOq','x3v7n3ldGa','pSkOw1uqWQFcHg9OWQ56','WRlcJSkBaGXDW5G','W53cOfFdGSkZW6ldTW','W4tdRXxcS3PVWPuEWRe','W5CaeSkMnW','yCkuWPCztCkaW4m','aCkqWP4SqW','W47cI8kyWR/dLW','5OU25yMV6AgQ5y+CvSk1iq','Bmk0yuymWQ/cNN0','W44qxmoIk8kPW4rodcS','W5zfamkyiXL3tMTnjq','DmkzitrGedOu','hColW53cU8kG','WOdcRK/dM1XkWOa9WOH7','WP3cKvddVSklWQDeC8kZiCoRWO/dHSov','W4uexSolDZ8N','WOzZBSoA','ASk+u1y','agGzWRtcQW','W5jfvSoNuWvkFq','WQRdSCkAW4VdQSkCWPpcV8krrq','WQC/W5X1WR7dUa','WOJcR0hdKcTwWRGQWPvzxW','W7CUtIC','WRTmW6NdPhPJWQRcQW','WOvSW5G','WQVcJrbBb8orDG8','WOrWW5G','W74Ora','W5iCW4nrWQK','e0pdUGtcSCk3','W6rbWOFdTNi','W77cJajkamol','W7JcQmkuW6NdHCk8WRFcSW','oSo2WPJdQW','WPBdTYGBqSoxsxxdRCkpW6JcN8kS','W5ldSHFcKg9VWOeqWRzrDq','WR7dVSkaW6tdRq'];}())];}());ll11iI11=function(){return i1Ii1li1;};return ll11iI11();};l1IIil[lII11I(0x98,'M9N)')](l1I1Il1,function(l11iili1,iIlil11l,liI1Iiii){const iIiii11=lII11I,iI111lll={'dHsMa':function(ii1lII1I,i11l1lii){return ii1lII1I===i11l1lii;},'yaRxQ':iIiii11(0xa8,'9X)4'),'iJPgk':iIiii11(0xa7,'2!aa'),'uemkC':iIiii11(0xb7,'0d[&'),'IoFdI':iIiii11(0xcf,'pESu'),'wcsJi':iIiii11(0xc2,'2!aa'),'SCOCx':iIiii11(0xad,'CP1n'),'bIKGQ':iIiii11(0xbb,'JSnU'),'FlzoD':iIiii11(0x89,'U0Qv')};if(l11iili1){if(iI111lll[iIiii11(0xa5,'KXVO')](iI111lll[iIiii11(0x9a,'vQEW')],iI111lll[iIiii11(0xb1,'Rdok')])){l1IIil[iIiii11(0x8f,'WxCw')](iI111lll[iIiii11(0x85,'Y&[3')],l11iili1),l1IIil[iIiii11(0x7d,'oLOy')]();return;}else{const ili1iIi1=iliI1li[iIiii11(0xaa,'*EZM')](lI1liiII,arguments);return lliI11il=null,ili1iIi1;}}try{l1IIil[iIiii11(0x9d,'a*H8')](liI1Iiii);const liI111I=JSON[iIiii11(0xb0,'x4e(')](liI1Iiii);iI111lll[iIiii11(0xce,'a*H8')](liI111I[iIiii11(0xe8,'1qLd')],0x1)?l1IIil[iIiii11(0x7c,'8y9&')](iI111lll[iIiii11(0xd4,'DT7R')],iI111lll[iIiii11(0xaf,'!Y98')],''):l1IIil[iIiii11(0xe1,'EvtB')](iI111lll[iIiii11(0xed,'nL5P')],iIiii11(0xa9,'EvtB'),'');}catch(l1ii1Ill){l1IIil[iIiii11(0xe3,'EvtB')](iI111lll[iIiii11(0xcd,'H8$Q')],l1ii1Ill),l1IIil[iIiii11(0xbc,'@Wt0')](iI111lll[iIiii11(0x8c,'oLOy')],iI111lll[iIiii11(0xab,'*vpt')],'');}finally{l1IIil[iIiii11(0xdf,'##SG')]();}});
//
function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,a)=>{s.call(this,t,(t,s,r)=>{t?a(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const a=this.getdata(t);if(a)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,a)=>e(a))})}runScript(t,e){return new Promise(s=>{let a=this.getdata("@chavy_boxjs_userCfgs.httpapi");a=a?a.replace(/\n/g,"").trim():a;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[i,o]=a.split("@"),n={url:`http://${o}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":i,Accept:"*/*"},timeout:r};this.post(n,(t,e,a)=>s(a))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e);if(!s&&!a)return{};{const a=s?t:e;try{return JSON.parse(this.fs.readFileSync(a))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):a?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const a=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of a)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,a)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[a+1])>>0==+e[a+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,a]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,a,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,a,r]=/^@(.*?)\.(.*?)$/.exec(e),i=this.getval(a),o=a?"null"===i?null:i||"{}":"{}";try{const e=JSON.parse(o);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),a)}catch(e){const i={};this.lodash_set(i,r,t),s=this.setval(JSON.stringify(i),a)}}else s=this.setval(t,e);return s}getval(t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(t);case"Quantumult X":return $prefs.valueForKey(t);case"Node.js":return this.data=this.loaddata(),this.data[t];default:return this.data&&this.data[t]||null}}setval(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(t,e);case"Quantumult X":return $prefs.setValueForKey(t,e);case"Node.js":return this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0;default:return this.data&&this.data[e]||null}}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){switch(t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"],delete t.headers["content-type"],delete t.headers["content-length"]),t.params&&(t.url+="?"+this.queryStr(t.params)),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:a,statusCode:r,headers:i,rawBody:o}=t,n=s.decode(o,this.encoding);e(null,{status:a,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:a,response:r}=t;e(a,r,r&&s.decode(r.rawBody,this.encoding))})}}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";switch(t.body&&t.headers&&!t.headers["Content-Type"]&&!t.headers["content-type"]&&(t.headers["content-type"]="application/x-www-form-urlencoded"),t.headers&&(delete t.headers["Content-Length"],delete t.headers["content-length"]),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:r,...i}=t;this.got[s](r,i).then(t=>{const{statusCode:s,statusCode:r,headers:i,rawBody:o}=t,n=a.decode(o,this.encoding);e(null,{status:s,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:s,response:r}=t;e(s,r,r&&a.decode(r.rawBody,this.encoding))})}}time(t,e=null){const s=e?new Date(e):new Date;let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}queryStr(t){let e="";for(const s in t){let a=t[s];null!=a&&""!==a&&("object"==typeof a&&(a=JSON.stringify(a)),e+=`${s}=${a}&`)}return e=e.substring(0,e.length-1),e}msg(e=t,s="",a="",r){const i=t=>{switch(typeof t){case void 0:return t;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:t};case"Loon":case"Shadowrocket":return t;case"Quantumult X":return{"open-url":t};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{let e=t.url||t.openUrl||t["open-url"];return{url:e}}case"Loon":{let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}case"Quantumult X":{let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl,a=t["update-pasteboard"]||t.updatePasteboard;return{"open-url":e,"media-url":s,"update-pasteboard":a}}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,a,i(r));break;case"Quantumult X":$notify(e,s,a,i(r));break;case"Node.js":}if(!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),a&&t.push(a),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t.stack)}}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(t);break;case"Node.js":process.exit(1)}}}(t,e)}
